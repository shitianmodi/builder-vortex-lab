import { useState } from "react";

interface CompleteRecordingModalProps {
  isOpen: boolean;
  onClose: () => void;
  onConfirm: (option: "direct" | "review" | "save") => void;
  mode?: "video" | "photo";
}

export default function CompleteRecordingModal({
  isOpen,
  onClose,
  onConfirm,
  mode = "video",
}: CompleteRecordingModalProps) {
  const [selectedOption, setSelectedOption] = useState<
    "direct" | "review" | "save"
  >("direct");

  if (!isOpen) return null;

  const handleConfirm = () => {
    onConfirm(selectedOption);
    onClose();
  };

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div className="w-[569px] bg-white rounded-3xl p-8 flex flex-col gap-6">
        {/* Header */}
        <div className="flex justify-between items-center">
          <div className="flex flex-col gap-1">
            <h2 className="text-[#3D526C] text-2xl font-semibold">
              完成{mode === "photo" ? "拍摄" : "录像"}
            </h2>
            <p className="text-[#CB2F2F] text-base">
              完成后无法继续当前{mode === "photo" ? "拍摄" : "录像"}。
            </p>
          </div>
          <p className="text-[#A8ABB2] text-base">*生成报告可能需要3~5分钟</p>
        </div>

        {/* Options */}
        <div className="flex flex-col gap-4">
          {/* Direct Report Generation */}
          <div
            className={`flex justify-between items-center p-6 rounded-3xl border-2 cursor-pointer ${
              selectedOption === "direct"
                ? "border-[#004DA9]"
                : "border-[#E2E7F0]"
            }`}
            onClick={() => setSelectedOption("direct")}
          >
            <div className="flex items-center gap-3">
              <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
                <path
                  d="M36.377 53.8021C35.0473 54.4645 33.4851 53.4974 33.4851 52.0119V46.1607L42.6003 43.8902L33.4851 41.6197V35.7684C33.4851 34.2829 35.0473 33.3159 36.377 33.9783L52.6797 42.1C54.1572 42.8361 54.1572 44.9442 52.6797 45.6803L36.377 53.8021ZM15.2548 52.9722C14.0015 52.9722 12.929 52.528 12.0372 51.6394C11.1454 50.7509 10.6988 49.6815 10.6973 48.4312V39.8033C12.5203 39.8033 14.1154 39.2265 15.4827 38.0731C16.85 36.9197 17.5336 35.453 17.5336 33.6729C17.5336 31.8928 16.85 30.4268 15.4827 29.2749C14.1154 28.123 12.5203 27.5455 10.6973 27.5425V18.9146C10.6973 17.6658 11.1439 16.5971 12.0372 15.7086C12.9305 14.8201 14.003 14.3751 15.2548 14.3735H24.37C24.37 12.7842 24.9207 11.4408 26.0221 10.3434C27.1235 9.24597 28.4718 8.69727 30.067 8.69727C31.6621 8.69727 33.0104 9.24597 34.1118 10.3434C35.2132 11.4408 35.7639 12.7842 35.7639 14.3735H44.8791C46.1324 14.3735 47.2057 14.8186 48.099 15.7086C48.9923 16.5986 49.4382 17.6673 49.4367 18.9146V35.3758L31.8194 26.5991C30.4898 25.9367 28.9276 26.9038 28.9276 28.3893V46.2742C27.4084 46.5769 26.193 47.2869 25.2815 48.4039C24.37 49.521 23.9142 51.0438 23.9142 52.9722H15.2548Z"
                  fill="#004DA9"
                />
              </svg>
              <div className="flex flex-col gap-1">
                <span className="text-[#324459] text-lg font-semibold">
                  直接生成报告
                </span>
                <span className="text-[#909399] text-base">
                  {mode === "photo"
                    ? "不检查识别内容，直接生成报告"
                    : "我已确认识别内容，可以直接生成报告。"}
                </span>
              </div>
            </div>
            <div
              className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${
                selectedOption === "direct"
                  ? "border-[#004DA9]"
                  : "border-[#B6C2DA]"
              }`}
            >
              {selectedOption === "direct" && (
                <div className="w-3 h-3 bg-[#004DA9] rounded-full"></div>
              )}
            </div>
          </div>

          {/* Enter Recording Review */}
          <div
            className={`flex justify-between items-center p-6 rounded-3xl border cursor-pointer ${
              selectedOption === "review"
                ? "border-[#004DA9] border-2"
                : "border-[#E2E7F0]"
            }`}
            onClick={() => setSelectedOption("review")}
          >
            <div className="flex items-center gap-3">
              <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
                <path
                  d="M14.4 53C13.19 53 12.1545 52.5652 11.2936 51.6956C10.4327 50.8259 10.0015 49.7793 10 48.5556V17.4444C10 16.2222 10.4312 15.1763 11.2936 14.3067C12.156 13.437 13.1915 13.0015 14.4 13H49.6C50.81 13 51.8462 13.4356 52.7086 14.3067C53.571 15.1778 54.0015 16.2237 54 17.4444V48.5556C54 49.7778 53.5695 50.8244 52.7086 51.6956C51.8477 52.5667 50.8115 53.0015 49.6 53H14.4ZM25.4 44.1111C26.0233 44.1111 26.5462 43.8978 26.9686 43.4711C27.391 43.0444 27.6015 42.517 27.6 41.8889C27.5985 41.2607 27.3873 40.7333 26.9664 40.3067C26.5455 39.88 26.0233 39.6667 25.4 39.6667H18.8C18.1767 39.6667 17.6545 39.88 17.2336 40.3067C16.8127 40.7333 16.6015 41.2607 16.6 41.8889C16.5985 42.517 16.8097 43.0452 17.2336 43.4733C17.6575 43.9015 18.1796 44.1141 18.8 44.1111H25.4ZM37.61 33.3889L36.015 31.7778C35.575 31.3333 35.0617 31.1207 34.475 31.14C33.8883 31.1593 33.375 31.3904 32.935 31.8333C32.5317 32.2778 32.3205 32.7963 32.3014 33.3889C32.2823 33.9815 32.4935 34.5 32.935 34.9444L36.07 38.1111C36.51 38.5556 37.0233 38.7778 37.61 38.7778C38.1967 38.7778 38.71 38.5556 39.15 38.1111L46.96 30.2222C47.4 29.7778 47.62 29.2593 47.62 28.6667C47.62 28.0741 47.4 27.5556 46.96 27.1111C46.52 26.6667 45.9979 26.4444 45.3936 26.4444C44.7893 26.4444 44.2665 26.6667 43.825 27.1111L37.61 33.3889ZM25.4 35.2222C26.0233 35.2222 26.5462 35.0089 26.9686 34.5822C27.391 34.1556 27.6015 33.6281 27.6 33C27.5985 32.3719 27.3873 31.8444 26.9664 31.4178C26.5455 30.9911 26.0233 30.7778 25.4 30.7778H18.8C18.1767 30.7778 17.6545 30.9911 17.2336 31.4178C16.8127 31.8444 16.6015 32.3719 16.6 33C16.5985 33.6281 16.8097 34.1563 17.2336 34.5844C17.6575 35.0126 18.1796 35.2252 18.8 35.2222H25.4ZM25.4 26.3333C26.0233 26.3333 26.5462 26.12 26.9686 25.6933C27.391 25.2667 27.6015 24.7393 27.6 24.1111C27.5985 23.483 27.3873 22.9556 26.9664 22.5289C26.5455 22.1022 26.0233 21.8889 25.4 21.8889H18.8C18.1767 21.8889 17.6545 22.1022 17.2336 22.5289C16.8127 22.9556 16.6015 23.483 16.6 24.1111C16.5985 24.7393 16.8097 25.2674 17.2336 25.6956C17.6575 26.1237 18.1796 26.3363 18.8 26.3333H25.4Z"
                  fill="#A8BDE8"
                />
              </svg>
              <div className="flex flex-col gap-1">
                <span className="text-[#324459] text-lg font-semibold">
                  {mode === "photo" ? "进入照片检查" : "进入录像检查"}
                </span>
                <span className="text-[#909399] text-base">
                  手动核对识别内容。
                </span>
              </div>
            </div>
            <div
              className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${
                selectedOption === "review"
                  ? "border-[#004DA9]"
                  : "border-[#B6C2DA]"
              }`}
            >
              {selectedOption === "review" && (
                <div className="w-3 h-3 bg-[#004DA9] rounded-full"></div>
              )}
            </div>
          </div>

          {/* Save Video */}
          <div
            className={`flex justify-between items-center p-6 rounded-3xl border cursor-pointer ${
              selectedOption === "save"
                ? "border-[#004DA9] border-2"
                : "border-[#E2E7F0]"
            }`}
            onClick={() => setSelectedOption("save")}
          >
            <div className="flex items-center gap-3">
              <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M12 11.8723C12 11.3758 12.196 10.8995 12.5449 10.5484C12.8938 10.1973 13.367 10 13.8605 10H50.1395C50.633 10 51.1062 10.1973 51.4551 10.5484C51.804 10.8995 52 11.3758 52 11.8723C52 12.3689 51.804 12.8452 51.4551 13.1963C51.1062 13.5474 50.633 13.7447 50.1395 13.7447H48.5963C48.9033 19.5817 46.8484 23.582 44.6112 26.5084C43.8019 27.5672 42.9033 28.5586 42.1674 29.3712C41.8419 29.7317 41.546 30.0574 41.306 30.3374C40.8735 30.8401 40.5851 31.2239 40.4056 31.5385C40.2307 31.8474 40.2251 31.9803 40.2251 32C40.2251 32.0197 40.2307 32.1526 40.4056 32.4615C40.5851 32.7761 40.8735 33.1599 41.306 33.6626C41.546 33.9435 41.8409 34.2683 42.1674 34.6278C42.9033 35.4404 43.8019 36.4328 44.6112 37.4916C46.8484 40.418 48.9033 44.4183 48.5963 50.2553H50.1395C50.633 50.2553 51.1062 50.4526 51.4551 50.8037C51.804 51.1548 52 51.6311 52 52.1277C52 52.6242 51.804 53.1005 51.4551 53.4516C51.1062 53.8027 50.633 54 50.1395 54H13.8605C13.367 54 12.8938 53.8027 12.5449 53.4516C12.196 53.1005 12 52.6242 12 52.1277C12 51.6311 12.196 51.1548 12.5449 50.8037C12.8938 50.4526 13.367 50.2553 13.8605 50.2553H15.4037C15.0977 44.4183 17.1526 40.418 19.3898 37.4916C20.1991 36.4328 21.0977 35.4414 21.8335 34.6288C22.16 34.2683 22.4549 33.9426 22.6958 33.6626C23.1284 33.1599 23.4167 32.7761 23.5953 32.4615C23.7712 32.1526 23.7767 32.0197 23.7767 32C23.7767 31.9803 23.7712 31.8474 23.5953 31.5385C23.4167 31.2239 23.1284 30.8401 22.6958 30.3374C22.4549 30.0565 22.1609 29.7317 21.8344 29.3722C21.0977 28.5596 20.1991 27.5672 19.3898 26.5084C17.1526 23.582 15.0977 19.5817 15.4037 13.7447H13.8605C13.367 13.7447 12.8938 13.5474 12.5449 13.1963C12.196 12.8452 12 12.3689 12 11.8723ZM19.1312 50.2553H44.8698C45.1749 45.3872 43.5116 42.194 41.6623 39.7749C40.9423 38.8322 40.253 38.0739 39.574 37.3268C39.2074 36.9272 38.8464 36.5224 38.4912 36.1126C38.014 35.5574 37.5358 34.9546 37.1749 34.3189C36.8102 33.6767 36.5042 32.8959 36.5042 32C36.5042 31.1041 36.8112 30.3224 37.1749 29.6811C37.5358 29.0445 38.014 28.4426 38.4912 27.8874C38.8512 27.4689 39.2112 27.0729 39.574 26.6732C40.253 25.9261 40.9414 25.1678 41.6623 24.2251C43.5116 21.806 45.1749 18.6137 44.8698 13.7447H19.1302C18.826 18.6128 20.4893 21.806 22.3395 24.2251C23.0586 25.1669 23.7479 25.9261 24.4279 26.6732C24.7907 27.072 25.1498 27.4689 25.5098 27.8874C25.987 28.4426 26.4651 29.0454 26.826 29.6811C27.1907 30.3224 27.4977 31.1041 27.4977 32C27.4977 32.8959 27.1907 33.6776 26.826 34.3189C26.4651 34.9555 25.987 35.5574 25.5098 36.1126C25.1498 36.5311 24.7898 36.9271 24.427 37.3268C23.7479 38.0739 23.0595 38.8322 22.3386 39.7749C20.4893 42.194 18.826 45.3863 19.1312 50.2553ZM32 37.0104C30.8567 37.0104 29.666 37.4691 28.5721 38.1188C27.4651 38.7769 26.3777 39.6766 25.4233 40.668C24.4679 41.6594 23.6214 42.765 23.0093 43.8529C22.4074 44.9191 21.9786 46.0585 21.9786 47.0948C21.9786 47.3431 22.0766 47.5812 22.2511 47.7568C22.4255 47.9324 22.6621 48.031 22.9088 48.031H41.0912C41.3379 48.031 41.5745 47.9324 41.7489 47.7568C41.9234 47.5812 42.0214 47.3431 42.0214 47.0948C42.0214 46.0585 41.5916 44.9191 40.9907 43.8529C40.3777 42.766 39.5321 41.6594 38.5767 40.668C37.6214 39.6766 36.5349 38.7769 35.427 38.1188C34.333 37.4691 33.1423 37.0104 32 37.0104ZM32 18.8805C34.7153 18.8805 37.4791 19.2915 39.6186 20.1528C39.8387 20.2415 40.0168 20.4114 40.1166 20.6279C40.2163 20.8443 40.2302 21.091 40.1553 21.3174C39.627 22.9117 38.2484 24.6445 36.7721 25.9551C36.0214 26.6217 35.2112 27.2096 34.4167 27.6374C33.6391 28.055 32.7963 28.362 32.0019 28.362C31.2084 28.362 30.3647 28.055 29.587 27.6374C28.7926 27.2096 27.9814 26.6217 27.2307 25.9551C25.7535 24.6445 24.373 22.9126 23.8447 21.3174C23.7696 21.0907 23.7834 20.8438 23.8834 20.6271C23.9834 20.4104 24.1619 20.2404 24.3823 20.1518C26.5209 19.2924 29.2837 18.8814 32 18.8805Z"
                  fill="#A8BDE8"
                />
              </svg>
              <div className="flex flex-col gap-1">
                <span className="text-[#324459] text-lg font-semibold">
                  {mode === "photo" ? "暂存照片" : "暂存视频"}
                </span>
                <span className="text-[#909399] text-base">
                  我需要稍后核对识别内容，再生成报告。
                </span>
              </div>
            </div>
            <div
              className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${
                selectedOption === "save"
                  ? "border-[#004DA9]"
                  : "border-[#B6C2DA]"
              }`}
            >
              {selectedOption === "save" && (
                <div className="w-3 h-3 bg-[#004DA9] rounded-full"></div>
              )}
            </div>
          </div>
        </div>

        {/* Divider */}
        <div className="h-px bg-[#E2E7F0]"></div>

        {/* Buttons */}
        <div className="flex gap-6 justify-center">
          <button
            onClick={onClose}
            className="flex-1 border border-[#004DA9] text-[#004DA9] py-3 px-4 rounded-2xl text-lg font-semibold hover:bg-blue-50 transition-colors"
          >
            取消
          </button>
          <button
            onClick={handleConfirm}
            className="flex-1 bg-[#004DA9] text-white py-3 px-4 rounded-2xl text-lg font-semibold hover:bg-blue-700 transition-colors"
          >
            确认
          </button>
        </div>
      </div>
    </div>
  );
}
