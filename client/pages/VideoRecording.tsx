import { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";

type RecordingState = "recording" | "paused";
type LogsState = "expanded" | "collapsed";

interface LogEntry {
  timestamp: string;
  message: string;
}

export default function VideoRecording() {
  const navigate = useNavigate();
  const [recordingState, setRecordingState] =
    useState<RecordingState>("recording");
  const [logsState, setLogsState] = useState<LogsState>("expanded");
  const [showExitDialog, setShowExitDialog] = useState(false);
  const [recordingTime, setRecordingTime] = useState(0);

  const logs: LogEntry[] = [
    { timestamp: "00:00", message: "在左上位置朝向右上放置了红色小汽车" },
    { timestamp: "01:00", message: "在左上位置加入水" },
    { timestamp: "02:00", message: "来访者与咨询师发生对话" },
    { timestamp: "03:00", message: "来访者自言自语" },
    { timestamp: "04:00", message: "咨询师插入笔记" },
  ];

  // Format time as MM:SS
  const formatTime = (seconds: number) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins.toString().padStart(2, "0")}:${secs.toString().padStart(2, "0")}`;
  };

  // Timer effect
  useEffect(() => {
    let interval: NodeJS.Timeout;
    if (recordingState === "recording") {
      interval = setInterval(() => {
        setRecordingTime((prev) => prev + 1);
      }, 1000);
    }
    return () => clearInterval(interval);
  }, [recordingState]);

  const handleExit = () => {
    setShowExitDialog(true);
  };

  const confirmExit = () => {
    navigate("/dashboard");
  };

  const handlePauseResume = () => {
    setRecordingState((prev) =>
      prev === "recording" ? "paused" : "recording",
    );
  };

  const toggleLogs = () => {
    setLogsState((prev) => (prev === "expanded" ? "collapsed" : "expanded"));
  };

  return (
    <div className="w-full h-screen bg-[#EEF1FA] overflow-hidden relative">
      {/* Top Bar */}
      <div className="flex justify-between items-center px-14 py-14 h-32">
        {/* Controls */}
        <div className="flex items-center gap-9">
          <div className="flex items-center gap-4">
            {/* Exit Button */}
            <button
              onClick={handleExit}
              className="flex h-12 px-4 py-2 justify-center items-center gap-2 rounded-2xl bg-[#CB2F2F] hover:bg-red-600 transition-colors"
            >
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path
                  d="M12 13.597L6.41065 19.1863C6.20152 19.3954 5.93536 19.5 5.61217 19.5C5.28897 19.5 5.02281 19.3954 4.81369 19.1863C4.60456 18.9772 4.5 18.711 4.5 18.3878C4.5 18.0646 4.60456 17.7985 4.81369 17.5894L10.403 12L4.81369 6.41065C4.60456 6.20152 4.5 5.93536 4.5 5.61217C4.5 5.28897 4.60456 5.02281 4.81369 4.81369C5.02281 4.60456 5.28897 4.5 5.61217 4.5C5.93536 4.5 6.20152 4.60456 6.41065 4.81369L12 10.403L17.5894 4.81369C17.7985 4.60456 18.0646 4.5 18.3878 4.5C18.711 4.5 18.9772 4.60456 19.1863 4.81369C19.3954 5.02281 19.5 5.28897 19.5 5.61217C19.5 5.93536 19.3954 6.20152 19.1863 6.41065L13.597 12L19.1863 17.5894C19.3954 17.7985 19.5 18.0646 19.5 18.3878C19.5 18.711 19.3954 18.9772 19.1863 19.1863C18.9772 19.3954 18.711 19.5 18.3878 19.5C18.0646 19.5 17.7985 19.3954 17.5894 19.1863L12 13.597Z"
                  fill="white"
                />
              </svg>
              <span className="text-white text-lg font-semibold">退出</span>
            </button>

            {/* Pause/Resume Button */}
            <button
              onClick={handlePauseResume}
              className={`flex h-12 px-4 py-2 justify-center items-center gap-2 rounded-2xl border ${
                recordingState === "recording"
                  ? "border-[#CB2F2F] hover:bg-red-50"
                  : "border-[#0D802C] hover:bg-green-50"
              } transition-colors`}
            >
              {recordingState === "recording" ? (
                <>
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M8.85 16.2H15.15C15.4475 16.2 15.697 16.0992 15.8986 15.8976C16.1002 15.696 16.2007 15.4468 16.2 15.15V8.85C16.2 8.5525 16.0992 8.3033 15.8976 8.1024C15.696 7.9015 15.4468 7.8007 15.15 7.8H8.85C8.5525 7.8 8.3033 7.9008 8.1024 8.1024C7.9015 8.304 7.8007 8.5532 7.8 8.85V15.15C7.8 15.4475 7.9008 15.697 8.1024 15.8986C8.304 16.1002 8.5532 16.2007 8.85 16.2ZM12 22.5C10.5475 22.5 9.1825 22.2242 7.905 21.6726C6.6275 21.121 5.51625 20.373 4.57125 19.4287C3.62625 18.4844 2.8783 17.3732 2.3274 16.095C1.7765 14.8168 1.5007 13.4518 1.5 12C1.4993 10.5482 1.7751 9.1832 2.3274 7.905C2.8797 6.6268 3.62765 5.51555 4.57125 4.57125C5.51485 3.62695 6.6261 2.879 7.905 2.3274C9.1839 1.7758 10.5489 1.5 12 1.5C13.4511 1.5 14.8161 1.7758 16.095 2.3274C17.3739 2.879 18.4851 3.62695 19.4287 4.57125C20.3723 5.51555 21.1206 6.6268 21.6736 7.905C22.2266 9.1832 22.5021 10.5482 22.5 12C22.4979 13.4518 22.2221 14.8168 21.6726 16.095C21.1231 17.3732 20.3751 18.4844 19.4287 19.4287C18.4823 20.373 17.3711 21.1213 16.095 21.6736C14.8189 22.2259 13.4539 22.5014 12 22.5Z"
                      fill="#CB2F2F"
                    />
                  </svg>
                  <span className="text-[#CB2F2F] text-lg font-semibold">
                    暂停
                  </span>
                </>
              ) : (
                <>
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M10.5825 15.9375L15.7012 12.6562C15.9462 12.4987 16.0687 12.28 16.0687 12C16.0687 11.72 15.9462 11.5012 15.7012 11.3437L10.5825 8.0625C10.32 7.8875 10.0529 7.8742 9.78135 8.0226C9.50975 8.171 9.3743 8.40305 9.375 8.71875V15.2812C9.375 15.5962 9.5108 15.8283 9.7824 15.9774C10.054 16.1265 10.3207 16.1132 10.5825 15.9375ZM12 22.5C10.5475 22.5 9.1825 22.2242 7.905 21.6726C6.6275 21.121 5.51625 20.373 4.57125 19.4287C3.62625 18.4844 2.8783 17.3732 2.3274 16.095C1.7765 14.8168 1.5007 13.4518 1.5 12C1.4993 10.5482 1.7751 9.1832 2.3274 7.905C2.8797 6.6268 3.62765 5.51555 4.57125 4.57125C5.51485 3.62695 6.6261 2.879 7.905 2.3274C9.1839 1.7758 10.5489 1.5 12 1.5C13.4511 1.5 14.8161 1.7758 16.095 2.3274C17.3739 2.879 18.4851 3.62695 19.4287 4.57125C20.3723 5.51555 21.1206 6.6268 21.6736 7.905C22.2266 9.1832 22.5021 10.5482 22.5 12C22.4979 13.4518 22.2221 14.8168 21.6726 16.095C21.1231 17.3732 20.3751 18.4844 19.4287 19.4287C18.4823 20.373 17.3711 21.1213 16.095 21.6736C14.8189 22.2259 13.4539 22.5014 12 22.5Z"
                      fill="#0D802C"
                    />
                  </svg>
                  <span className="text-[#0D802C] text-lg font-semibold">
                    继续
                  </span>
                </>
              )}
            </button>
          </div>

          {/* Separator */}
          <div className="w-px h-6 bg-[#B6C2DA]"></div>

          {/* Recording Status */}
          <div className="flex items-center gap-4">
            <div className="w-4 h-4 bg-[#CB2F2F] rounded-full"></div>
            <span className="text-[#3D526C] text-2xl font-semibold">
              {recordingState === "recording" ? "录制中" : "暂停录制"}
            </span>
            <span className="text-[#3D526C] text-2xl font-semibold">
              {formatTime(recordingTime)}
            </span>
          </div>
        </div>

        {/* Function Buttons */}
        <div className="flex items-center gap-4">
          <button
            onClick={() => navigate('/log-viewer')}
            className="flex h-12 px-4 py-2 justify-center items-center gap-2 rounded-2xl border border-[#004DA9] hover:bg-blue-50 transition-colors"
          >
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M10.1667 18.5625C9.90694 18.5625 9.68939 18.4725 9.514 18.2925C9.33861 18.1125 9.25061 17.89 9.25 17.625C9.24939 17.36 9.33739 17.1375 9.514 16.9575C9.69061 16.7775 9.90817 16.6875 10.1667 16.6875H19.3333C19.5931 16.6875 19.8109 16.7775 19.9869 16.9575C20.1629 17.1375 20.2506 17.36 20.25 17.625C20.2494 17.89 20.1614 18.1128 19.986 18.2934C19.8106 18.474 19.5931 18.5637 19.3333 18.5625H10.1667ZM10.1667 12.9375C9.90694 12.9375 9.68939 12.8475 9.514 12.6675C9.33861 12.4875 9.25061 12.265 9.25 12C9.24939 11.735 9.33739 11.5125 9.514 11.3325C9.69061 11.1525 9.90817 11.0625 10.1667 11.0625H19.3333C19.5931 11.0625 19.8109 11.1525 19.9869 11.3325C20.1629 11.5125 20.2506 11.735 20.25 12C20.2494 12.265 20.1614 12.4878 19.986 12.6684C19.8106 12.8491 19.5931 12.9387 19.3333 12.9375H10.1667ZM10.1667 7.3125C9.90694 7.3125 9.68939 7.2225 9.514 7.0425C9.33861 6.8625 9.25061 6.64 9.25 6.375C9.24939 6.11 9.33739 5.8875 9.514 5.7075C9.69061 5.5275 9.90817 5.4375 10.1667 5.4375H19.3333C19.5931 5.4375 19.8109 5.5275 19.9869 5.7075C20.1629 5.8875 20.2506 6.11 20.25 6.375C20.2494 6.64 20.1614 6.86281 19.986 7.04344C19.8106 7.22406 19.5931 7.31375 19.3333 7.3125H10.1667ZM5.58333 19.5C5.07917 19.5 4.64772 19.3165 4.289 18.9497C3.93028 18.5828 3.75061 18.1412 3.75 17.625C3.74939 17.1087 3.92906 16.6675 4.289 16.3012C4.64895 15.935 5.08039 15.7512 5.58333 15.75C6.08628 15.7487 6.51803 15.9325 6.87858 16.3012C7.23914 16.67 7.4185 17.1112 7.41667 17.625C7.41483 18.1387 7.23547 18.5803 6.87858 18.9497C6.5217 19.319 6.08995 19.5025 5.58333 19.5ZM5.58333 13.875C5.07917 13.875 4.64772 13.6915 4.289 13.3247C3.93028 12.9578 3.75061 12.5162 3.75 12C3.74939 11.4837 3.92906 11.0425 4.289 10.6762C4.64895 10.31 5.08039 10.1262 5.58333 10.125C6.08628 10.1237 6.51803 10.3075 6.87858 10.6762C7.23914 11.045 7.4185 11.4862 7.41667 12C7.41483 12.5137 7.23547 12.9553 6.87858 13.3247C6.5217 13.694 6.08995 13.8775 5.58333 13.875ZM5.58333 8.25C5.07917 8.25 4.64772 8.06656 4.289 7.69969C3.93028 7.33281 3.75061 6.89125 3.75 6.375C3.74939 5.85875 3.92906 5.4175 4.289 5.05125C4.64895 4.68501 5.08039 4.50126 5.58333 4.50001C6.08628 4.49876 6.51803 4.68251 6.87858 5.05125C7.23914 5.42 7.4185 5.86125 7.41667 6.375C7.41483 6.88875 7.23547 7.33031 6.87858 7.69969C6.5217 8.06906 6.08995 8.2525 5.58333 8.25Z"
                fill="#004DA9"
              />
            </svg>
            <span className="text-[#004DA9] text-lg font-semibold">
              查看日志
            </span>
          </button>

          <button className="flex h-12 px-4 py-2 justify-center items-center gap-2 rounded-2xl border border-[#004DA9] hover:bg-blue-50 transition-colors">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M9.30643 9.306V19.2009H15.603V16.5023C15.603 16.2474 15.6893 16.0339 15.862 15.8618C16.0347 15.6897 16.2482 15.6034 16.5025 15.6028H19.201V9.306H9.30643ZM7.50742 19.2009V9.28351C7.50742 8.78877 7.68732 8.36898 8.04712 8.02416C8.40693 7.67934 8.83419 7.50693 9.32892 7.50693H19.201C19.6957 7.50693 20.1194 7.68294 20.472 8.03495C20.8246 8.38697 21.0006 8.81066 21 9.306V15.7602C21 16.0001 20.955 16.2288 20.8651 16.4465C20.7751 16.6642 20.6477 16.8552 20.4828 17.0195L17.0197 20.4828C16.8548 20.6477 16.6635 20.7751 16.4458 20.8651C16.2281 20.955 15.9996 21 15.7604 21H9.30643C8.8117 21 8.38834 20.824 8.03633 20.472C7.68432 20.12 7.50802 19.6963 7.50742 19.2009ZM3.03238 6.83227C2.94243 6.33753 3.03988 5.89166 3.32472 5.49466C3.60956 5.09766 3.99935 4.85389 4.49408 4.76333L14.2537 3.03172C14.7334 2.94177 15.1682 3.04312 15.558 3.33577C15.9478 3.62842 16.2026 4.01432 16.3226 4.49347L16.48 5.19062C16.5549 5.49046 16.51 5.73034 16.3451 5.91025C16.1802 6.09015 15.9853 6.1951 15.7604 6.22508C15.5355 6.25507 15.322 6.21399 15.1199 6.10185C14.9178 5.98971 14.779 5.78341 14.7035 5.48296L14.546 4.80831L4.80891 6.53992L6.15816 14.276C6.20314 14.5308 6.15816 14.7593 6.02324 14.9614C5.88831 15.1635 5.69342 15.2873 5.43856 15.3329C5.1837 15.3785 4.95882 15.3299 4.76393 15.1872C4.56904 15.0445 4.4491 14.8457 4.40413 14.5908L3.03238 6.83227Z"
                fill="#004DA9"
              />
            </svg>
            <span className="text-[#004DA9] text-lg font-semibold">
              插入笔记
            </span>
          </button>

          <button
            onClick={() => navigate("/dashboard")}
            className="flex h-12 px-4 py-2 justify-center items-center gap-2 rounded-2xl bg-[#004DA9] hover:bg-blue-800 transition-colors"
          >
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M11.1205 13.7083L15.7636 9L14.5977 7.8125L11.1205 11.3542L9.38182 9.58333L8.23636 10.75L11.1205 13.7083ZM3 19.5V17.8333H21V19.5H3ZM5.45455 17C5.00455 17 4.61945 16.8369 4.29927 16.5108C3.97909 16.1847 3.81873 15.7922 3.81818 15.3333V6.16667C3.81818 5.70833 3.97855 5.31611 4.29927 4.99C4.62 4.66389 5.00509 4.50056 5.45455 4.5H18.5455C18.9955 4.5 19.3808 4.66333 19.7015 4.99C20.0223 5.31667 20.1824 5.70889 20.1818 6.16667V15.3333C20.1818 15.7917 20.0217 16.1842 19.7015 16.5108C19.3814 16.8375 18.996 17.0006 18.5455 17H5.45455ZM5.45455 15.3333H18.5455V6.16667H5.45455V15.3333Z"
                fill="white"
              />
            </svg>
            <span className="text-white text-lg font-semibold">完成拍摄</span>
          </button>
        </div>
      </div>

      {/* Divider */}
      <div className="w-full h-px bg-[#E2E7F0] mb-6"></div>

      {/* Video Content Area */}
      <div className="relative w-full h-[746px] bg-[#C7D4E8] mx-14 rounded-none">
        {/* Main Video */}
        <img
          src="https://api.builder.io/api/v1/image/assets/TEMP/54dd3ffbb7a664135600f3ba41729ad7c05babec?width=2656"
          alt="Main video view"
          className="w-full h-full object-cover"
        />

        {/* Real-time Logs Panel */}
        {logsState === "expanded" ? (
          <div className="absolute left-0 top-0 w-[306px] h-full bg-black bg-opacity-30 p-6 flex flex-col gap-4">
            {/* Header */}
            <div className="flex justify-between items-center pb-2">
              <div className="flex items-center gap-2">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M10.1667 18.5625C9.90694 18.5625 9.68939 18.4725 9.514 18.2925C9.33861 18.1125 9.25061 17.89 9.25 17.625C9.24939 17.36 9.33739 17.1375 9.514 16.9575C9.69061 16.7775 9.90817 16.6875 10.1667 16.6875H19.3333C19.5931 16.6875 19.8109 16.7775 19.9869 16.9575C20.1629 17.1375 20.2506 17.36 20.25 17.625C20.2494 17.89 20.1614 18.1128 19.986 18.2934C19.8106 18.474 19.5931 18.5637 19.3333 18.5625H10.1667ZM10.1667 12.9375C9.90694 12.9375 9.68939 12.8475 9.514 12.6675C9.33861 12.4875 9.25061 12.265 9.25 12C9.24939 11.735 9.33739 11.5125 9.514 11.3325C9.69061 11.1525 9.90817 11.0625 10.1667 11.0625H19.3333C19.5931 11.0625 19.8109 11.1525 19.9869 11.3325C20.1629 11.5125 20.2506 11.735 20.25 12C20.2494 12.265 20.1614 12.4878 19.986 12.6684C19.8106 12.8491 19.5931 12.9387 19.3333 12.9375H10.1667ZM10.1667 7.3125C9.90694 7.3125 9.68939 7.2225 9.514 7.0425C9.33861 6.8625 9.25061 6.64 9.25 6.375C9.24939 6.11 9.33739 5.8875 9.514 5.7075C9.69061 5.5275 9.90817 5.4375 10.1667 5.4375H19.3333C19.5931 5.4375 19.8109 5.5275 19.9869 5.7075C20.1629 5.8875 20.2506 6.11 20.25 6.375C20.2494 6.64 20.1614 6.86281 19.986 7.04344C19.8106 7.22406 19.5931 7.31375 19.3333 7.3125H10.1667ZM5.58333 19.5C5.07917 19.5 4.64772 19.3165 4.289 18.9497C3.93028 18.5828 3.75061 18.1412 3.75 17.625C3.74939 17.1087 3.92906 16.6675 4.289 16.3012C4.64895 15.935 5.08039 15.7512 5.58333 15.75C6.08628 15.7487 6.51803 15.9325 6.87858 16.3012C7.23914 16.67 7.4185 17.1112 7.41667 17.625C7.41483 18.1387 7.23547 18.5803 6.87858 18.9497C6.5217 19.319 6.08995 19.5025 5.58333 19.5ZM5.58333 13.875C5.07917 13.875 4.64772 13.6915 4.289 13.3247C3.93028 12.9578 3.75061 12.5162 3.75 12C3.74939 11.4837 3.92906 11.0425 4.289 10.6762C4.64895 10.31 5.08039 10.1262 5.58333 10.125C6.08628 10.1237 6.51803 10.3075 6.87858 10.6762C7.23914 11.045 7.4185 11.4862 7.41667 12C7.41483 12.5137 7.23547 12.9553 6.87858 13.3247C6.5217 13.694 6.08995 13.8775 5.58333 13.875ZM5.58333 8.25C5.07917 8.25 4.64772 8.06656 4.289 7.69969C3.93028 7.33281 3.75061 6.89125 3.75 6.375C3.74939 5.85875 3.92906 5.4175 4.289 5.05125C4.64895 4.68501 5.08039 4.50126 5.58333 4.50001C6.08628 4.49876 6.51803 4.68251 6.87858 5.05125C7.23914 5.42 7.4185 5.86125 7.41667 6.375C7.41483 6.88875 7.23547 7.33031 6.87858 7.69969C6.5217 8.06906 6.08995 8.2525 5.58333 8.25Z"
                    fill="white"
                  />
                </svg>
                <span className="text-white text-lg">实时日志</span>
              </div>
              <button onClick={toggleLogs}>
                <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M10.4514 3.29837C10.9079 3.7548 10.9079 4.49481 10.4514 4.95124L4.40287 10.9998L10.4514 17.0484C10.9079 17.5048 10.9079 18.2448 10.4514 18.7012C9.99501 19.1577 9.255 19.1577 8.79857 18.7012L1.92357 11.8262C1.46715 11.3698 1.46715 10.6298 1.92357 10.1734L8.79857 3.29837C9.255 2.84195 9.99501 2.84195 10.4514 3.29837Z"
                    fill="white"
                  />
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M20.0764 3.29837C20.5329 3.7548 20.5329 4.49481 20.0764 4.95124L14.0279 10.9998L20.0764 17.0484C20.5329 17.5048 20.5329 18.2448 20.0764 18.7012C19.62 19.1577 18.88 19.1577 18.4236 18.7012L11.5486 11.8262C11.0921 11.3698 11.0921 10.6298 11.5486 10.1734L18.4236 3.29837C18.88 2.84195 19.62 2.84195 20.0764 3.29837Z"
                    fill="white"
                  />
                </svg>
              </button>
            </div>

            {/* Separator */}
            <div className="w-full h-px bg-[#C7C9CC]"></div>

            {/* Log Entries */}
            <div className="space-y-4 flex-1 overflow-y-auto">
              {logs.map((log, index) => (
                <div key={index} className="flex gap-4">
                  <span className="text-white text-base w-11 flex-shrink-0">
                    {log.timestamp}
                  </span>
                  <span className="text-white text-base leading-7">
                    {log.message}
                  </span>
                </div>
              ))}
            </div>
          </div>
        ) : (
          /* Collapsed logs button */
          <button
            onClick={toggleLogs}
            className="absolute left-3 top-3 flex items-center gap-2 px-3 py-2 bg-black bg-opacity-30 rounded-3xl"
          >
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M10.1667 18.5625C9.90694 18.5625 9.68939 18.4725 9.514 18.2925C9.33861 18.1125 9.25061 17.89 9.25 17.625C9.24939 17.36 9.33739 17.1375 9.514 16.9575C9.69061 16.7775 9.90817 16.6875 10.1667 16.6875H19.3333C19.5931 16.6875 19.8109 16.7775 19.9869 16.9575C20.1629 17.1375 20.2506 17.36 20.25 17.625C20.2494 17.89 20.1614 18.1128 19.986 18.2934C19.8106 18.474 19.5931 18.5637 19.3333 18.5625H10.1667ZM10.1667 12.9375C9.90694 12.9375 9.68939 12.8475 9.514 12.6675C9.33861 12.4875 9.25061 12.265 9.25 12C9.24939 11.735 9.33739 11.5125 9.514 11.3325C9.69061 11.1525 9.90817 11.0625 10.1667 11.0625H19.3333C19.5931 11.0625 19.8109 11.1525 19.9869 11.3325C20.1629 11.5125 20.2506 11.735 20.25 12C20.2494 12.265 20.1614 12.4878 19.986 12.6684C19.8106 12.8491 19.5931 12.9387 19.3333 12.9375H10.1667ZM10.1667 7.3125C9.90694 7.3125 9.68939 7.2225 9.514 7.0425C9.33861 6.8625 9.25061 6.64 9.25 6.375C9.24939 6.11 9.33739 5.8875 9.514 5.7075C9.69061 5.5275 9.90817 5.4375 10.1667 5.4375H19.3333C19.5931 5.4375 19.8109 5.5275 19.9869 5.7075C20.1629 5.8875 20.2506 6.11 20.25 6.375C20.2494 6.64 20.1614 6.86281 19.986 7.04344C19.8106 7.22406 19.5931 7.31375 19.3333 7.3125H10.1667ZM5.58333 19.5C5.07917 19.5 4.64772 19.3165 4.289 18.9497C3.93028 18.5828 3.75061 18.1412 3.75 17.625C3.74939 17.1087 3.92906 16.6675 4.289 16.3012C4.64895 15.935 5.08039 15.7512 5.58333 15.75C6.08628 15.7487 6.51803 15.9325 6.87858 16.3012C7.23914 16.67 7.4185 17.1112 7.41667 17.625C7.41483 18.1387 7.23547 18.5803 6.87858 18.9497C6.5217 19.319 6.08995 19.5025 5.58333 19.5ZM5.58333 13.875C5.07917 13.875 4.64772 13.6915 4.289 13.3247C3.93028 12.9578 3.75061 12.5162 3.75 12C3.74939 11.4837 3.92906 11.0425 4.289 10.6762C4.64895 10.31 5.08039 10.1262 5.58333 10.125C6.08628 10.1237 6.51803 10.3075 6.87858 10.6762C7.23914 11.045 7.4185 11.4862 7.41667 12C7.41483 12.5137 7.23547 12.9553 6.87858 13.3247C6.5217 13.694 6.08995 13.8775 5.58333 13.875ZM5.58333 8.25C5.07917 8.25 4.64772 8.06656 4.289 7.69969C3.93028 7.33281 3.75061 6.89125 3.75 6.375C3.74939 5.85875 3.92906 5.4175 4.289 5.05125C4.64895 4.68501 5.08039 4.50126 5.58333 4.50001C6.08628 4.49876 6.51803 4.68251 6.87858 5.05125C7.23914 5.42 7.4185 5.86125 7.41667 6.375C7.41483 6.88875 7.23547 7.33031 6.87858 7.69969C6.5217 8.06906 6.08995 8.2525 5.58333 8.25Z"
                fill="white"
              />
            </svg>
            <span className="text-white text-lg">实时日志</span>
          </button>
        )}

        {/* Secondary Video View */}
        <div className="absolute top-0 right-0 w-80 h-45 border-4 border-white">
          <img
            src="https://api.builder.io/api/v1/image/assets/TEMP/1880c3b089ce961d65c171f7b7a093a3f0885f1c?width=640"
            alt="Secondary video view"
            className="w-full h-full object-cover"
          />
          {/* Video controls overlay */}
          <div className="absolute top-3 right-3 flex gap-2">
            <button className="w-10 h-10 bg-black bg-opacity-30 rounded-full flex items-center justify-center">
              <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                <path
                  d="M21.6118 21.6701V20.3918C20.8819 21.2443 20.0101 21.9756 19.0261 22.5451C17.1275 23.6438 14.9206 24.0858 12.7456 23.8046C10.5704 23.5234 8.54767 22.5339 6.98975 20.9882C5.52936 19.5392 4.55362 17.6771 4.18872 15.6579L4.12378 15.2529L4.11523 15.0222C4.14903 14.4941 4.54997 14.045 5.09448 13.9694C5.63874 13.8943 6.14538 14.2176 6.32153 14.7163L6.37622 14.9401L6.48901 15.5639C6.81076 17.0052 7.53949 18.3283 8.59277 19.3733C9.7964 20.5674 11.3586 21.3317 13.0378 21.5488C14.7168 21.7657 16.42 21.4232 17.8862 20.5747C18.8272 20.03 19.6352 19.2949 20.2668 18.4248H18.375C17.747 18.4248 17.2372 17.9162 17.2368 17.2883C17.2368 16.6601 17.7468 16.1501 18.375 16.1501H22.75C23.3782 16.1501 23.8882 16.6601 23.8882 17.2883V21.6701C23.8882 22.2983 23.3782 22.8083 22.75 22.8083C22.1218 22.8083 21.6118 22.2983 21.6118 21.6701ZM8.97388 5.45528C10.8725 4.35656 13.0794 3.91461 15.2544 4.19576C17.4296 4.47696 19.4523 5.46649 21.0103 7.01217C22.5678 8.55761 23.5744 10.5729 23.8762 12.7475C23.9625 13.3698 23.5278 13.9447 22.9055 14.031C22.3613 14.1061 21.8546 13.7829 21.6785 13.2841L21.6238 13.0603L21.511 12.4365C21.1892 10.9952 20.4605 9.67216 19.4072 8.62716C18.2036 7.43302 16.6414 6.66871 14.9622 6.45162C13.2832 6.23472 11.58 6.5772 10.1138 7.42574C9.17276 7.97039 8.3648 8.70553 7.73315 9.57564H9.625C10.253 9.57564 10.7628 10.0842 10.7632 10.7121C10.7632 11.3403 10.2532 11.8503 9.625 11.8503H5.25C4.62178 11.8503 4.11182 11.3403 4.11182 10.7121V6.33028C4.11182 5.70206 4.62178 5.1921 5.25 5.1921C5.87822 5.1921 6.38818 5.70206 6.38818 6.33028V7.60689C7.11797 6.75479 7.99033 6.02456 8.97388 5.45528Z"
                  fill="white"
                />
              </svg>
            </button>
            <button className="w-10 h-10 bg-black bg-opacity-30 rounded-full flex items-center justify-center">
              <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                <path
                  d="M14 15.8631L7.47909 22.384C7.23511 22.628 6.92459 22.75 6.54753 22.75C6.17047 22.75 5.85995 22.628 5.61597 22.384C5.37199 22.14 5.25 21.8295 5.25 21.4525C5.25 21.0754 5.37199 20.7649 5.61597 20.5209L12.1369 14L5.61597 7.47909C5.37199 7.23511 5.25 6.92459 5.25 6.54753C5.25 6.17047 5.37199 5.85995 5.61597 5.61597C5.85995 5.37199 6.17047 5.25 6.54753 5.25C6.92459 5.25 7.23511 5.37199 7.47909 5.61597L14 12.1369L20.5209 5.61597C20.7649 5.37199 21.0754 5.25 21.4525 5.25C21.8295 5.25 22.14 5.37199 22.384 5.61597C22.628 5.85995 22.75 6.17047 22.75 6.54753C22.75 6.92459 22.628 7.23511 22.384 7.47909L15.8631 14L22.384 20.5209C22.628 20.7649 22.75 21.0754 22.75 21.4525C22.75 21.8295 22.628 22.14 22.384 22.384C22.14 22.628 21.8295 22.75 21.4525 22.75C21.0754 22.75 20.7649 22.628 20.5209 22.384L14 15.8631Z"
                  fill="white"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      {/* Exit Confirmation Dialog */}
      {showExitDialog && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white p-8 rounded-3xl w-96 max-w-md">
            <h3 className="text-2xl font-semibold text-[#3D526C] text-center mb-6">
              退出录像
            </h3>

            {/* Exit Icon */}
            <div className="flex justify-center mb-6">
              <div className="w-35 h-35 bg-[#A8BDE8] rounded-full flex items-center justify-center">
                <svg width="129" height="134" viewBox="0 0 130 135" fill="none">
                  <path
                    d="M24.5625 2.06839C26.2342 0.508718 28.5748 0.0630018 30.6924 0.954131C32.6986 1.84541 34.0361 3.85094 34.0361 6.07913V19.9473H67.4951C74.3937 19.9475 79.9862 25.5581 79.9863 32.4795V43.2217C79.9863 47.6713 76.391 51.2783 71.9561 51.2784C67.5211 51.2783 63.9258 47.6713 63.9258 43.2217V36.0606H34.0361V97.8291H63.9258V90.667C63.9259 86.2175 67.5212 82.6104 71.9561 82.6104C76.3909 82.6104 79.9862 86.2176 79.9863 90.667V101.409C79.9863 108.331 74.3938 113.942 67.4951 113.942H34.0361V128.63C34.036 130.858 32.6985 132.864 30.6924 133.755C29.9125 134.089 29.2438 134.2 28.4639 134.2C27.015 134.2 25.677 133.643 24.5625 132.641L2.27148 111.139C1.24291 110.051 0.648164 108.624 0.599609 107.128V27.5811C0.599609 26.1329 1.2685 24.6844 2.27148 23.5703L24.5625 2.06839ZM101.606 39.2793C103.724 38.3882 106.065 38.9452 107.625 40.5049L126.237 59.4444C130.473 63.7893 130.473 70.8084 126.126 75.1534L107.736 93.5352C107.239 94.0702 106.635 94.4954 105.963 94.7832C105.291 95.071 104.566 95.216 103.835 95.2071C103.166 95.207 102.386 95.0949 101.718 94.7608C100.7 94.3429 99.8287 93.6336 99.2139 92.7217C98.599 91.8097 98.2682 90.7355 98.2627 89.6358L98.2266 75.0479H50.6143C46.2562 75.0478 42.7236 71.601 42.7236 67.3496C42.7238 63.0984 46.2563 59.6524 50.6143 59.6524H98.1885L98.1514 44.4043C98.1514 42.1761 99.4888 40.0592 101.606 39.2793Z"
                    fill="#A8BDE8"
                  />
                </svg>
              </div>
            </div>

            <div className="text-center mb-6">
              <p className="text-lg text-[#324459] mb-2">
                是否退出当前的沙盘录像？
              </p>
              <p className="text-base text-[#CB2F2F]">
                退出后，已录制的内容将不会被保存。
              </p>
            </div>

            <div className="h-px bg-[#E2E7F0] mb-6"></div>

            <div className="flex gap-6">
              <button
                onClick={confirmExit}
                className="flex-1 py-3 px-4 border border-[#004DA9] text-[#004DA9] rounded-2xl text-lg font-semibold hover:bg-blue-50 transition-colors"
              >
                确认
              </button>
              <button
                onClick={() => setShowExitDialog(false)}
                className="flex-1 py-3 px-4 bg-[#004DA9] text-white rounded-2xl text-lg font-semibold hover:bg-blue-800 transition-colors"
              >
                取消
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
